<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1JM61D9WMN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-1JM61D9WMN');
    </script>
    <title>ğŸŒ ë‹¤êµ­ì–´ QR ì½”ë“œ ìƒì„±ê¸°</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fb;
            margin: 0;
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 600px;
            width: 100%;
            background: white;
            border-radius: 32px;
            padding: 28px 24px;
            box-shadow: 0 16px 40px rgba(0,0,0,0.06);
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        h2 {
            margin: 0;
            font-size: 1.9rem;
            font-weight: 700;
            color: #0b2b4a;
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .lang-selector {
            padding: 8px 12px;
            border-radius: 40px;
            border: 1.5px solid #e2e8f0;
            background: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        .status {
            background: #f0f6ff;
            padding: 12px 18px;
            border-radius: 40px;
            font-size: 0.95rem;
            color: #1e3a5f;
            margin-bottom: 24px;
            border-left: 5px solid #3b82f6;
        }
        select, input, textarea, button {
            width: 100%;
            padding: 15px 18px;
            margin: 8px 0;
            border: 1.5px solid #e2e8f0;
            border-radius: 20px;
            font-size: 16px;
            background: white;
            transition: 0.2s;
        }
        button {
            background: #3b82f6;
            color: white;
            font-weight: 700;
            border: none;
            border-radius: 20px;
            padding: 16px;
            font-size: 17px;
            cursor: pointer;
            box-shadow: 0 6px 16px rgba(59,130,246,0.3);
            margin-top: 12px;
        }
        .qr-box {
            background: white;
            padding: 28px;
            border-radius: 28px;
            margin: 28px 0 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px dashed #b9c7da;
            min-height: 300px;
        }
        #qrcode canvas, #qrcode img {
            max-width: 100%;
            height: auto;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.04);
        }
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        .btn-group button {
            flex: 1 1 calc(50% - 6px);
            margin: 0;
        }
        .btn-download {
            background: #1e293b;
        }
        .btn-share {
            background: #0e7b6e;
        }
        .btn-print {
            background: #7b4e96;
        }
        .footer-note {
            font-size: 13px;
            color: #5f6c80;
            margin-top: 28px;
            text-align: center;
            border-top: 1px solid #e2e8f0;
            padding-top: 20px;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2 data-i18n="appTitle">âš¡ ë“€ì–¼ QR</h2>
            <select id="languageSelect" class="lang-selector">
                <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡</option>
            </select>
        </div>
        <div class="status" id="statusMessage" data-i18n="statusLoading">
            ğŸ”„ QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ì¤‘...
        </div>

        <select id="typeSelect">
            <option value="text" data-i18n="typeText">ğŸ“ ì¼ë°˜ í…ìŠ¤íŠ¸</option>
            <option value="url" data-i18n="typeUrl">ğŸ”— URL</option>
            <option value="wifi" data-i18n="typeWifi">ğŸ“¶ WiFi</option>
            <option value="contact" data-i18n="typeContact">ğŸ“‡ ì—°ë½ì²˜</option>
            <option value="location" data-i18n="typeLocation">ğŸ“ ìœ„ì¹˜</option>
            <option value="email" data-i18n="typeEmail">ğŸ“§ ì´ë©”ì¼</option>
            <option value="calendar" data-i18n="typeCalendar">ğŸ“… ì¼ì •</option>
        </select>

        <!-- í…ìŠ¤íŠ¸ -->
        <div id="inputText" class="input-area">
            <textarea id="textValue" rows="3" data-i18n-placeholder="textPlaceholder" placeholder="í•œê¸€, æ—¥æœ¬èª, ä¸­æ–‡, English ëª¨ë‘ ê°€ëŠ¥">ì•ˆë…•í•˜ì„¸ìš”! QR ìƒì„±ê¸°</textarea>
        </div>
        <!-- URL -->
        <div id="inputUrl" class="input-area hidden">
            <input type="url" id="urlValue" data-i18n-placeholder="urlPlaceholder" placeholder="https://example.com">
        </div>
        <!-- WiFi -->
        <div id="inputWifi" class="input-area hidden">
            <input type="text" id="wifiSsid" data-i18n-placeholder="wifiSsidPlaceholder" placeholder="WiFi ì´ë¦„ (SSID)">
            <input type="text" id="wifiPass" data-i18n-placeholder="wifiPassPlaceholder" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <select id="wifiEncrypt">
                <option value="WPA" data-i18n="wifiWpa">WPA/WPA2</option>
                <option value="WEP" data-i18n="wifiWep">WEP</option>
                <option value="nopass" data-i18n="wifiNoPass">ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ</option>
            </select>
        </div>
        <!-- ì—°ë½ì²˜ -->
        <div id="inputContact" class="input-area hidden">
            <input type="text" id="contactName" data-i18n-placeholder="contactNamePlaceholder" placeholder="ì´ë¦„ (í•„ìˆ˜)">
            <input type="tel" id="contactPhone" data-i18n-placeholder="contactPhonePlaceholder" placeholder="ì „í™”ë²ˆí˜¸">
            <input type="email" id="contactEmail" data-i18n-placeholder="contactEmailPlaceholder" placeholder="ì´ë©”ì¼">
        </div>
        <!-- ìœ„ì¹˜ -->
        <div id="inputLocation" class="input-area hidden">
            <input type="text" id="locationLat" data-i18n-placeholder="locationLatPlaceholder" placeholder="ìœ„ë„ (ì˜ˆ: 37.5665)">
            <input type="text" id="locationLng" data-i18n-placeholder="locationLngPlaceholder" placeholder="ê²½ë„ (ì˜ˆ: 126.9780)">
            <input type="text" id="locationName" data-i18n-placeholder="locationNamePlaceholder" placeholder="ì¥ì†Œëª… (ì„ íƒ)">
        </div>
        <!-- ì´ë©”ì¼ -->
        <div id="inputEmail" class="input-area hidden">
            <input type="email" id="emailTo" data-i18n-placeholder="emailToPlaceholder" placeholder="ë°›ëŠ” ì‚¬ëŒ ì´ë©”ì¼">
            <input type="text" id="emailSubject" data-i18n-placeholder="emailSubjectPlaceholder" placeholder="ì œëª© (ì„ íƒ)">
            <textarea id="emailBody" rows="2" data-i18n-placeholder="emailBodyPlaceholder" placeholder="ë‚´ìš© (ì„ íƒ)"></textarea>
        </div>
        <!-- ì¼ì • -->
        <div id="inputCalendar" class="input-area hidden">
            <input type="text" id="eventTitle" data-i18n-placeholder="eventTitlePlaceholder" placeholder="ì¼ì • ì œëª©">
            <input type="datetime-local" id="eventStart">
            <input type="datetime-local" id="eventEnd">
            <input type="text" id="eventLocation" data-i18n-placeholder="eventLocationPlaceholder" placeholder="ì¥ì†Œ (ì„ íƒ)">
        </div>

        <button id="generateBtn" data-i18n="generateBtn">âœ¨ QR ì½”ë“œ ìƒì„±</button>

        <div class="qr-box">
            <div id="qrcode"></div>
        </div>

        <!-- ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ê·¸ë£¹ (PNG, JPG) -->
        <div class="btn-group">
            <button id="downloadPngBtn" class="btn-download" data-i18n="downloadPng">ğŸ“¥ PNG ì €ì¥</button>
            <button id="downloadJpgBtn" class="btn-download" data-i18n="downloadJpg">ğŸ–¼ï¸ JPG ì €ì¥</button>
        </div>

        <!-- ê³µìœ  ë° í”„ë¦°íŠ¸ ë²„íŠ¼ ê·¸ë£¹ -->
        <div class="btn-group">
            <button id="shareBtn" class="btn-share" data-i18n="shareBtn">ğŸ“¤ ê³µìœ í•˜ê¸°</button>
            <button id="printBtn" class="btn-print" data-i18n="printBtn">ğŸ–¨ï¸ í”„ë¦°íŠ¸</button>
        </div>

        <div class="footer-note" data-i18n="footerNote">
            âœ… ì•„ì´í°/ì•ˆë“œë¡œì´ë“œ 100% ì¸ì‹ | CDN ì‹¤íŒ¨ ì‹œ ìë™ ë‚´ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì „í™˜
        </div>
    </div>

    <script>
        // --------------------------------------------------------------
        // 0. ë‹¤êµ­ì–´ ë²ˆì—­ ë°ì´í„° (í•œêµ­ì–´, ì˜ì–´, ì¼ë³¸ì–´, ì¤‘êµ­ì–´ ê°„ì²´)
        //    ê³µìœ /í”„ë¦°íŠ¸ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì¶”ê°€
        // --------------------------------------------------------------
        const translations = {
            ko: {
                appTitle: "âš¡ ë“€ì–¼ QR",
                statusLoading: "ğŸ”„ QR ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ì¤‘...",
                typeText: "ğŸ“ ì¼ë°˜ í…ìŠ¤íŠ¸",
                typeUrl: "ğŸ”— URL",
                typeWifi: "ğŸ“¶ WiFi",
                typeContact: "ğŸ“‡ ì—°ë½ì²˜",
                typeLocation: "ğŸ“ ìœ„ì¹˜",
                typeEmail: "ğŸ“§ ì´ë©”ì¼",
                typeCalendar: "ğŸ“… ì¼ì •",
                textPlaceholder: "í•œê¸€, æ—¥æœ¬èª, ä¸­æ–‡, English ëª¨ë‘ ê°€ëŠ¥",
                urlPlaceholder: "https://example.com",
                wifiSsidPlaceholder: "WiFi ì´ë¦„ (SSID)",
                wifiPassPlaceholder: "ë¹„ë°€ë²ˆí˜¸",
                wifiWpa: "WPA/WPA2",
                wifiWep: "WEP",
                wifiNoPass: "ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ",
                contactNamePlaceholder: "ì´ë¦„ (í•„ìˆ˜)",
                contactPhonePlaceholder: "ì „í™”ë²ˆí˜¸",
                contactEmailPlaceholder: "ì´ë©”ì¼",
                locationLatPlaceholder: "ìœ„ë„ (ì˜ˆ: 37.5665)",
                locationLngPlaceholder: "ê²½ë„ (ì˜ˆ: 126.9780)",
                locationNamePlaceholder: "ì¥ì†Œëª… (ì„ íƒ)",
                emailToPlaceholder: "ë°›ëŠ” ì‚¬ëŒ ì´ë©”ì¼",
                emailSubjectPlaceholder: "ì œëª© (ì„ íƒ)",
                emailBodyPlaceholder: "ë‚´ìš© (ì„ íƒ)",
                eventTitlePlaceholder: "ì¼ì • ì œëª©",
                eventLocationPlaceholder: "ì¥ì†Œ (ì„ íƒ)",
                generateBtn: "âœ¨ QR ì½”ë“œ ìƒì„±",
                downloadPng: "ğŸ“¥ PNG ì €ì¥",
                downloadJpg: "ğŸ–¼ï¸ JPG ì €ì¥",
                shareBtn: "ğŸ“¤ ê³µìœ í•˜ê¸°",
                printBtn: "ğŸ–¨ï¸ í”„ë¦°íŠ¸",
                footerNote: "âœ… ì•„ì´í°/ì•ˆë“œë¡œì´ë“œ 100% ì¸ì‹ | CDN ì‹¤íŒ¨ ì‹œ ìë™ ë‚´ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì „í™˜",
                statusSuccess: "âœ… QRCode ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì„±ê³µ",
                statusFallback: "âœ… ë‚´ì¥ QR ì—”ì§„ ì¤€ë¹„ë¨ (UTF-8 ì§€ì›)",
                statusFallbackFail: "âŒ ë‚´ì¥ ì—”ì§„ ë¡œë“œ ì‹¤íŒ¨ - ì¸í„°ë„· ì—°ê²° í™•ì¸",
                statusCdnFail: "âš ï¸ CDN ë¡œë“œ ì‹¤íŒ¨, ë‚´ì¥ ì—”ì§„ìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤.",
                shareUnsupported: "ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” í™˜ê²½ì…ë‹ˆë‹¤.\nì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•œ í›„ ì§ì ‘ ê³µìœ í•´ì£¼ì„¸ìš”."
            },
            en: {
                appTitle: "âš¡ Dual QR",
                statusLoading: "ğŸ”„ Loading QR library...",
                typeText: "ğŸ“ Text",
                typeUrl: "ğŸ”— URL",
                typeWifi: "ğŸ“¶ WiFi",
                typeContact: "ğŸ“‡ Contact",
                typeLocation: "ğŸ“ Location",
                typeEmail: "ğŸ“§ Email",
                typeCalendar: "ğŸ“… Event",
                textPlaceholder: "English, æ—¥æœ¬èª, ä¸­æ–‡, í•œêµ­ì–´ all supported",
                urlPlaceholder: "https://example.com",
                wifiSsidPlaceholder: "Network Name (SSID)",
                wifiPassPlaceholder: "Password",
                wifiWpa: "WPA/WPA2",
                wifiWep: "WEP",
                wifiNoPass: "No Password",
                contactNamePlaceholder: "Name (required)",
                contactPhonePlaceholder: "Phone number",
                contactEmailPlaceholder: "Email",
                locationLatPlaceholder: "Latitude (e.g. 37.5665)",
                locationLngPlaceholder: "Longitude (e.g. 126.9780)",
                locationNamePlaceholder: "Place name (optional)",
                emailToPlaceholder: "Recipient email",
                emailSubjectPlaceholder: "Subject (optional)",
                emailBodyPlaceholder: "Message (optional)",
                eventTitlePlaceholder: "Event title",
                eventLocationPlaceholder: "Location (optional)",
                generateBtn: "âœ¨ Generate QR Code",
                downloadPng: "ğŸ“¥ Save PNG",
                downloadJpg: "ğŸ–¼ï¸ Save JPG",
                shareBtn: "ğŸ“¤ Share",
                printBtn: "ğŸ–¨ï¸ Print",
                footerNote: "âœ… 100% recognized on iPhone/Android | Auto fallback if CDN fails",
                statusSuccess: "âœ… QRCode library loaded successfully",
                statusFallback: "âœ… Built-in QR engine ready (UTF-8 supported)",
                statusFallbackFail: "âŒ Built-in engine failed - check internet connection",
                statusCdnFail: "âš ï¸ CDN load failed, switching to built-in engine.",
                shareUnsupported: "Sharing is not supported on this device/browser.\nPlease download the image and share it manually."
            },
            ja: {
                appTitle: "âš¡ ãƒ‡ãƒ¥ã‚¢ãƒ«QR",
                statusLoading: "ğŸ”„ QRãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ä¸­...",
                typeText: "ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ",
                typeUrl: "ğŸ”— URL",
                typeWifi: "ğŸ“¶ WiFi",
                typeContact: "ğŸ“‡ é€£çµ¡å…ˆ",
                typeLocation: "ğŸ“ ä½ç½®æƒ…å ±",
                typeEmail: "ğŸ“§ ãƒ¡ãƒ¼ãƒ«",
                typeCalendar: "ğŸ“… äºˆå®š",
                textPlaceholder: "æ—¥æœ¬èª, English, ä¸­æ–‡, í•œêµ­ì–´ å¯¾å¿œ",
                urlPlaceholder: "https://example.com",
                wifiSsidPlaceholder: "WiFiå (SSID)",
                wifiPassPlaceholder: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰",
                wifiWpa: "WPA/WPA2",
                wifiWep: "WEP",
                wifiNoPass: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—",
                contactNamePlaceholder: "åå‰ (å¿…é ˆ)",
                contactPhonePlaceholder: "é›»è©±ç•ªå·",
                contactEmailPlaceholder: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹",
                locationLatPlaceholder: "ç·¯åº¦ (ä¾‹: 37.5665)",
                locationLngPlaceholder: "çµŒåº¦ (ä¾‹: 126.9780)",
                locationNamePlaceholder: "å ´æ‰€å (ä»»æ„)",
                emailToPlaceholder: "é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«",
                emailSubjectPlaceholder: "ä»¶å (ä»»æ„)",
                emailBodyPlaceholder: "æœ¬æ–‡ (ä»»æ„)",
                eventTitlePlaceholder: "äºˆå®šã‚¿ã‚¤ãƒˆãƒ«",
                eventLocationPlaceholder: "å ´æ‰€ (ä»»æ„)",
                generateBtn: "âœ¨ QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ",
                downloadPng: "ğŸ“¥ PNGä¿å­˜",
                downloadJpg: "ğŸ–¼ï¸ JPGä¿å­˜",
                shareBtn: "ğŸ“¤ å…±æœ‰",
                printBtn: "ğŸ–¨ï¸ å°åˆ·",
                footerNote: "âœ… iPhone/Android 100%èªè­˜ | CDNå¤±æ•—æ™‚ã¯è‡ªå‹•ã§å†…è”µã‚¨ãƒ³ã‚¸ãƒ³ã«åˆ‡æ›¿",
                statusSuccess: "âœ… QRCodeãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«æˆåŠŸã—ã¾ã—ãŸ",
                statusFallback: "âœ… å†…è”µQRã‚¨ãƒ³ã‚¸ãƒ³æº–å‚™å®Œäº† (UTF-8å¯¾å¿œ)",
                statusFallbackFail: "âŒ å†…è”µã‚¨ãƒ³ã‚¸ãƒ³ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                statusCdnFail: "âš ï¸ CDNã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€å†…è”µã‚¨ãƒ³ã‚¸ãƒ³ã«åˆ‡æ›¿ãˆã¾ã™",
                shareUnsupported: "ãŠä½¿ã„ã®ç’°å¢ƒã§ã¯å…±æœ‰æ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‹ã‚‰æ‰‹å‹•ã§å…±æœ‰ã—ã¦ãã ã•ã„ã€‚"
            },
            zh: {
                appTitle: "âš¡ åŒæ ¸QR",
                statusLoading: "ğŸ”„ æ­£åœ¨åŠ è½½QRåº“...",
                typeText: "ğŸ“ æ–‡æœ¬",
                typeUrl: "ğŸ”— URL",
                typeWifi: "ğŸ“¶ WiFi",
                typeContact: "ğŸ“‡ è”ç³»äºº",
                typeLocation: "ğŸ“ ä½ç½®",
                typeEmail: "ğŸ“§ ç”µå­é‚®ä»¶",
                typeCalendar: "ğŸ“… æ—¥ç¨‹",
                textPlaceholder: "ä¸­æ–‡, English, æ—¥æœ¬èª, í•œêµ­ì–´ éƒ½æ”¯æŒ",
                urlPlaceholder: "https://example.com",
                wifiSsidPlaceholder: "WiFiåç§° (SSID)",
                wifiPassPlaceholder: "å¯†ç ",
                wifiWpa: "WPA/WPA2",
                wifiWep: "WEP",
                wifiNoPass: "æ— å¯†ç ",
                contactNamePlaceholder: "å§“å (å¿…å¡«)",
                contactPhonePlaceholder: "ç”µè¯å·ç ",
                contactEmailPlaceholder: "ç”µå­é‚®ä»¶",
                locationLatPlaceholder: "çº¬åº¦ (ä¾‹å¦‚: 37.5665)",
                locationLngPlaceholder: "ç»åº¦ (ä¾‹å¦‚: 126.9780)",
                locationNamePlaceholder: "åœ°ç‚¹åç§° (å¯é€‰)",
                emailToPlaceholder: "æ”¶ä»¶äººé‚®ç®±",
                emailSubjectPlaceholder: "ä¸»é¢˜ (å¯é€‰)",
                emailBodyPlaceholder: "å†…å®¹ (å¯é€‰)",
                eventTitlePlaceholder: "æ—¥ç¨‹æ ‡é¢˜",
                eventLocationPlaceholder: "åœ°ç‚¹ (å¯é€‰)",
                generateBtn: "âœ¨ ç”ŸæˆäºŒç»´ç ",
                downloadPng: "ğŸ“¥ ä¿å­˜PNG",
                downloadJpg: "ğŸ–¼ï¸ ä¿å­˜JPG",
                shareBtn: "ğŸ“¤ åˆ†äº«",
                printBtn: "ğŸ–¨ï¸ æ‰“å°",
                footerNote: "âœ… iPhone/Android 100%è¯†åˆ« | CDNå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å†…ç½®å¼•æ“",
                statusSuccess: "âœ… QRCodeåº“åŠ è½½æˆåŠŸ",
                statusFallback: "âœ… å†…ç½®QRå¼•æ“å·²å‡†å¤‡ (æ”¯æŒUTF-8)",
                statusFallbackFail: "âŒ å†…ç½®å¼•æ“åŠ è½½å¤±è´¥ - è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥",
                statusCdnFail: "âš ï¸ CDNåŠ è½½å¤±è´¥ï¼Œæ­£åœ¨åˆ‡æ¢åˆ°å†…ç½®å¼•æ“",
                shareUnsupported: "æ‚¨çš„è®¾å¤‡æˆ–æµè§ˆå™¨ä¸æ”¯æŒåˆ†äº«åŠŸèƒ½ã€‚\nè¯·ä¸‹è½½å›¾ç‰‡åæ‰‹åŠ¨åˆ†äº«ã€‚"
            }
        };

        // --------------------------------------------------------------
        // 1. ì–¸ì–´ ì„¤ì • ê´€ë ¨ ë³€ìˆ˜ ë° í•¨ìˆ˜
        // --------------------------------------------------------------
        let currentLang = localStorage.getItem('qr_lang') || detectBrowserLanguage();

        function setLanguage(langCode) {
            if (!translations[langCode]) langCode = 'ko';
            currentLang = langCode;
            localStorage.setItem('qr_lang', langCode);
            
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) langSelect.value = langCode;

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[langCode][key]) {
                    el.innerHTML = translations[langCode][key];
                }
            });

            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[langCode][key]) {
                    el.placeholder = translations[langCode][key];
                }
            });

            document.querySelectorAll('option[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[langCode][key]) {
                    el.textContent = translations[langCode][key];
                }
            });
        }

        document.getElementById('languageSelect').addEventListener('change', function(e) {
            setLanguage(e.target.value);
        });

        function detectBrowserLanguage() {
            const savedLang = localStorage.getItem('qr_lang');
            if (savedLang) return savedLang;
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('ko')) return 'ko';
            if (browserLang.startsWith('ja')) return 'ja';
            if (browserLang.startsWith('zh')) return 'zh';
            return 'en';
        }

        // --------------------------------------------------------------
        // 2. ìƒíƒœ í‘œì‹œ í•¨ìˆ˜ (ë²ˆì—­ ì ìš©)
        // --------------------------------------------------------------
        const statusEl = document.getElementById('statusMessage');
        function setStatus(msgKey, isError = false) {
            if (translations[currentLang] && translations[currentLang][msgKey]) {
                statusEl.innerHTML = translations[currentLang][msgKey];
            } else {
                statusEl.innerHTML = msgKey;
            }
            statusEl.style.background = isError ? '#ffeeee' : '#f0f6ff';
            statusEl.style.borderLeftColor = isError ? '#e53e3e' : '#3b82f6';
        }

        // --------------------------------------------------------------
        // 3. QRCode ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© (3ì¤‘ CDN + ë‚´ì¥ ë°±ì—…) - ê¸°ì¡´ ê·¸ëŒ€ë¡œ
        // --------------------------------------------------------------
        let QRCodeLib = null;
        let useFallback = false;

        function loadFallbackLibrary() {
            return new Promise((resolve) => {
                setStatus('statusFallback');
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js';
                script.onload = () => {
                    if (window.qrcode) {
                        qrcode.stringToBytes = qrcode.stringToBytesFuncs['UTF-8'];
                        setStatus('statusFallback');
                        useFallback = true;
                        resolve(true);
                    } else {
                        setStatus('statusFallbackFail', true);
                        resolve(false);
                    }
                };
                script.onerror = () => {
                    setStatus('statusFallbackFail', true);
                    resolve(false);
                };
                document.head.appendChild(script);
            });
        }

        function loadMainQRCode() {
            return new Promise((resolve) => {
                const cdnList = [
                    'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js',
                    'https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js',
                    'https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js'
                ];

                let attempts = 0;
                function tryNextCDN() {
                    if (attempts >= cdnList.length) {
                        setStatus('statusCdnFail', true);
                        loadFallbackLibrary().then(resolve);
                        return;
                    }
                    const script = document.createElement('script');
                    script.src = cdnList[attempts];
                    script.onload = () => {
                        if (window.QRCode) {
                            QRCodeLib = window.QRCode;
                            setStatus('statusSuccess');
                            resolve(true);
                        } else {
                            attempts++;
                            tryNextCDN();
                        }
                    };
                    script.onerror = () => {
                        attempts++;
                        tryNextCDN();
                    };
                    document.head.appendChild(script);
                }
                tryNextCDN();
            });
        }

        // --------------------------------------------------------------
        // 4. QR ìƒì„± ë²”ìš© í•¨ìˆ˜ (ê·¸ëŒ€ë¡œ ìœ ì§€)
        // --------------------------------------------------------------
        async function generateQR(text, options = {}) {
            const qrDiv = document.getElementById('qrcode');
            qrDiv.innerHTML = '';

            if (!text || !text.trim()) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return null;
            }

            const width = options.width || 300;
            const margin = options.margin || 4;

            try {
                if (!useFallback && QRCodeLib) {
                    const canvas = document.createElement('canvas');
                    await QRCodeLib.toCanvas(canvas, text, {
                        width: width,
                        margin: margin,
                        errorCorrectionLevel: 'H',
                        color: { dark: '#000000', light: '#ffffff' }
                    });
                    qrDiv.appendChild(canvas);
                    return canvas;
                } 
                else if (useFallback && window.qrcode) {
                    const qr = qrcode(0, 'H');
                    qr.addData(text);
                    qr.make();

                    const cellSize = Math.floor(width / qr.getModuleCount());
                    const actualSize = qr.getModuleCount() * cellSize;
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = actualSize + margin * 2 * cellSize;
                    canvas.height = actualSize + margin * 2 * cellSize;
                    const ctx = canvas.getContext('2d');
                    
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = '#000000';
                    for (let row = 0; row < qr.getModuleCount(); row++) {
                        for (let col = 0; col < qr.getModuleCount(); col++) {
                            if (qr.isDark(row, col)) {
                                ctx.fillRect(
                                    (col + margin) * cellSize,
                                    (row + margin) * cellSize,
                                    cellSize, cellSize
                                );
                            }
                        }
                    }
                    qrDiv.appendChild(canvas);
                    return canvas;
                }
                else {
                    setStatus('statusFallbackFail', true);
                    return null;
                }
            } catch (err) {
                console.error(err);
                alert('QR ìƒì„± ì˜¤ë¥˜: ' + err.message);
                return null;
            }
        }

        // --------------------------------------------------------------
        // 5. ë°ì´í„° í¬ë§· ë³€í™˜ (ê¸°ì¡´ê³¼ ë™ì¼)
        // --------------------------------------------------------------
        function getFormattedData() {
            const type = typeSelect.value;
            switch (type) {
                case 'text': return document.getElementById('textValue').value.trim();
                case 'url':
                    let url = document.getElementById('urlValue').value.trim();
                    if (!url) return '';
                    if (!url.startsWith('http')) url = 'https://' + url;
                    return url;
                case 'wifi':
                    const ssid = document.getElementById('wifiSsid').value.trim();
                    const pass = document.getElementById('wifiPass').value.trim();
                    const enc = document.getElementById('wifiEncrypt').value;
                    if (!ssid) return '';
                    return `WIFI:S:${ssid};T:${enc};P:${pass};;`;
                case 'contact':
                    const name = document.getElementById('contactName').value.trim();
                    const phone = document.getElementById('contactPhone').value.trim();
                    const email = document.getElementById('contactEmail').value.trim();
                    if (!name) return '';
                    let vcard = 'BEGIN:VCARD\nVERSION:3.0\nFN:' + name + '\nN:' + name + ';;;\n';
                    if (phone) vcard += 'TEL:' + phone + '\n';
                    if (email) vcard += 'EMAIL:' + email + '\n';
                    vcard += 'END:VCARD';
                    return vcard;
                case 'location':
                    const lat = document.getElementById('locationLat').value.trim();
                    const lng = document.getElementById('locationLng').value.trim();
                    const locName = document.getElementById('locationName').value.trim();
                    if (!lat || !lng) return '';
                    return locName ? `geo:${lat},${lng}?q=${encodeURIComponent(locName)}` : `geo:${lat},${lng}`;
                case 'email':
                    const to = document.getElementById('emailTo').value.trim();
                    const subj = document.getElementById('emailSubject').value.trim();
                    const body = document.getElementById('emailBody').value.trim();
                    if (!to) return '';
                    let mailto = `mailto:${to}`;
                    const params = [];
                    if (subj) params.push(`subject=${encodeURIComponent(subj)}`);
                    if (body) params.push(`body=${encodeURIComponent(body)}`);
                    if (params.length) mailto += '?' + params.join('&');
                    return mailto;
                case 'calendar':
                    const title = document.getElementById('eventTitle').value.trim();
                    const start = document.getElementById('eventStart').value;
                    if (!title || !start) return '';
                    const startStr = start.replace(/-/g, '').replace(/:/g, '').replace('T', '');
                    const end = document.getElementById('eventEnd').value;
                    const endStr = end ? end.replace(/-/g, '').replace(/:/g, '').replace('T', '') : startStr;
                    const loc = document.getElementById('eventLocation').value.trim();
                    let vevent = 'BEGIN:VEVENT\nSUMMARY:' + title + '\nDTSTART:' + startStr + '\nDTEND:' + endStr + '\n';
                    if (loc) vevent += 'LOCATION:' + loc + '\n';
                    vevent += 'END:VEVENT';
                    return vevent;
                default: return '';
            }
        }

        // --------------------------------------------------------------
        // 6. ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜ (PNG/JPG) - ê¸°ì¡´ ê·¸ëŒ€ë¡œ
        // --------------------------------------------------------------
        async function downloadQR(format = 'png') {
            const data = getFormattedData();
            if (!data) { alert('QR ì½”ë“œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.'); return; }
            
            const canvas = await generateQR(data, { width: 512, margin: 8 });
            if (!canvas) return;

            const mime = format === 'png' ? 'image/png' : 'image/jpeg';
            const url = canvas.toDataURL(mime, 0.95);
            const link = document.createElement('a');
            link.href = url;
            link.download = `qrcode_${Date.now()}.${format}`;
            link.click();
        }

        // --------------------------------------------------------------
        // 7. ê³µìœ  ê¸°ëŠ¥ (Web Share API)
        // --------------------------------------------------------------
        async function shareQR() {
            const canvas = document.querySelector('#qrcode canvas');
            if (!canvas) {
                alert(translations[currentLang]?.shareUnsupported || 'QR ì½”ë“œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê³ í•´ìƒë„ ì´ë¯¸ì§€ ìƒì„± (ê³µìœ ìš©)
            const shareCanvas = document.createElement('canvas');
            await (async () => {
                if (!useFallback && QRCodeLib) {
                    await QRCodeLib.toCanvas(shareCanvas, getFormattedData(), {
                        width: 512,
                        margin: 4,
                        errorCorrectionLevel: 'H'
                    });
                } else if (useFallback && window.qrcode) {
                    const qr = qrcode(0, 'H');
                    qr.addData(getFormattedData());
                    qr.make();
                    const cellSize = 6;
                    const margin = 4;
                    shareCanvas.width = qr.getModuleCount() * cellSize + margin * 2 * cellSize;
                    shareCanvas.height = qr.getModuleCount() * cellSize + margin * 2 * cellSize;
                    const ctx = shareCanvas.getContext('2d');
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, shareCanvas.width, shareCanvas.height);
                    ctx.fillStyle = '#000000';
                    for (let row = 0; row < qr.getModuleCount(); row++) {
                        for (let col = 0; col < qr.getModuleCount(); col++) {
                            if (qr.isDark(row, col)) {
                                ctx.fillRect((col + margin) * cellSize, (row + margin) * cellSize, cellSize, cellSize);
                            }
                        }
                    }
                }
            })();

            shareCanvas.toBlob(async (blob) => {
                if (!blob) {
                    alert('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨');
                    return;
                }

                const file = new File([blob], 'qrcode.png', { type: 'image/png' });

                if (navigator.share) {
                    try {
                        await navigator.share({
                            title: 'QR Code',
                            text: 'QR ì½”ë“œë¥¼ ê³µìœ í•©ë‹ˆë‹¤',
                            files: [file]
                        });
                    } catch (err) {
                        if (err.name !== 'AbortError') {
                            alert('ê³µìœ  ì‹¤íŒ¨: ' + err.message);
                        }
                    }
                } else {
                    // Web Share API ë¯¸ì§€ì› í™˜ê²½: ë‹¤ìš´ë¡œë“œ ì•ˆë‚´
                    alert(translations[currentLang]?.shareUnsupported || 'ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” í™˜ê²½ì…ë‹ˆë‹¤.\nì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•œ í›„ ì§ì ‘ ê³µìœ í•´ì£¼ì„¸ìš”.');
                    // ë‹¤ìš´ë¡œë“œ ë§í¬ ì œê³µ
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'qrcode_share.png';
                    link.click();
                    URL.revokeObjectURL(url);
                }
            }, 'image/png');
        }

        // --------------------------------------------------------------
        // 8. í”„ë¦°íŠ¸ ê¸°ëŠ¥
        // --------------------------------------------------------------
        async function printQR() {
            const canvas = document.querySelector('#qrcode canvas');
            if (!canvas) {
                alert('QR ì½”ë“œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê³ í•´ìƒë„ ì´ë¯¸ì§€ë¡œ í”„ë¦°íŠ¸ (512px, ì—¬ë°± 8)
            const printCanvas = document.createElement('canvas');
            await (async () => {
                if (!useFallback && QRCodeLib) {
                    await QRCodeLib.toCanvas(printCanvas, getFormattedData(), {
                        width: 512,
                        margin: 8,
                        errorCorrectionLevel: 'H'
                    });
                } else if (useFallback && window.qrcode) {
                    const qr = qrcode(0, 'H');
                    qr.addData(getFormattedData());
                    qr.make();
                    const cellSize = 6;
                    const margin = 8;
                    printCanvas.width = qr.getModuleCount() * cellSize + margin * 2 * cellSize;
                    printCanvas.height = qr.getModuleCount() * cellSize + margin * 2 * cellSize;
                    const ctx = printCanvas.getContext('2d');
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, printCanvas.width, printCanvas.height);
                    ctx.fillStyle = '#000000';
                    for (let row = 0; row < qr.getModuleCount(); row++) {
                        for (let col = 0; col < qr.getModuleCount(); col++) {
                            if (qr.isDark(row, col)) {
                                ctx.fillRect((col + margin) * cellSize, (row + margin) * cellSize, cellSize, cellSize);
                            }
                        }
                    }
                }
            })();

            const imgUrl = printCanvas.toDataURL('image/png');
            const printWindow = window.open('', '_blank', 'width=600,height=600');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Print QR Code</title>
                    <style>
                        body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
                        img { max-width: 100%; max-height: 100%; object-fit: contain; }
                    </style>
                </head>
                <body>
                    <img src="${imgUrl}" onload="window.print(); window.onafterprint = function() { window.close(); }" />
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        // --------------------------------------------------------------
        // 9. UI ì´ë²¤íŠ¸ ì—°ê²° (ê¸°ì¡´ + ì‹ ê·œ)
        // --------------------------------------------------------------
        const typeSelect = document.getElementById('typeSelect');
        const areas = {
            text: document.getElementById('inputText'),
            url: document.getElementById('inputUrl'),
            wifi: document.getElementById('inputWifi'),
            contact: document.getElementById('inputContact'),
            location: document.getElementById('inputLocation'),
            email: document.getElementById('inputEmail'),
            calendar: document.getElementById('inputCalendar')
        };

        function showArea(type) {
            Object.values(areas).forEach(a => a.classList.add('hidden'));
            if (areas[type]) areas[type].classList.remove('hidden');
        }

        typeSelect.addEventListener('change', function() { showArea(this.value); });
        showArea('text');

        function setDefaultDates() {
            const now = new Date();
            const y = now.getFullYear();
            const m = String(now.getMonth()+1).padStart(2,'0');
            const d = String(now.getDate()).padStart(2,'0');
            const h = String(now.getHours()).padStart(2,'0');
            const min = String(now.getMinutes()).padStart(2,'0');
            const current = `${y}-${m}-${d}T${h}:${min}`;
            document.getElementById('eventStart').value = current;
            const tomorrow = new Date(now.getTime() + 86400000);
            const ty = tomorrow.getFullYear();
            const tm = String(tomorrow.getMonth()+1).padStart(2,'0');
            const td = String(tomorrow.getDate()).padStart(2,'0');
            document.getElementById('eventEnd').value = `${ty}-${tm}-${td}T${h}:${min}`;
        }
        setDefaultDates();

        // ìƒì„± ë²„íŠ¼
        document.getElementById('generateBtn').addEventListener('click', async () => {
            const data = getFormattedData();
            if (!data) { alert('í•„ìˆ˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
            await generateQR(data, { width: 300, margin: 4 });
        });

        // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
        document.getElementById('downloadPngBtn').addEventListener('click', () => downloadQR('png'));
        document.getElementById('downloadJpgBtn').addEventListener('click', () => downloadQR('jpg'));

        // ê³µìœ  ë²„íŠ¼
        document.getElementById('shareBtn').addEventListener('click', shareQR);

        // í”„ë¦°íŠ¸ ë²„íŠ¼
        document.getElementById('printBtn').addEventListener('click', printQR);

        // --------------------------------------------------------------
        // 10. ì‹œì‘: ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ í›„ ìƒ˜í”Œ ìƒì„±
        // --------------------------------------------------------------
        window.addEventListener('load', async () => {
            await loadMainQRCode();
            setLanguage(initialLang); // ì–¸ì–´ ì´ˆê¸°í™”
            setTimeout(() => {
                generateQR('ì•ˆë…•í•˜ì„¸ìš”! QR ìƒì„±ê¸°', { width: 300, margin: 4 });
            }, 100);
        });
        const initialLang = detectBrowserLanguage();
    </script>
</body>
</html>
